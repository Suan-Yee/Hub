<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" >
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DIR ACE Technology</title>
    <meta content="" name="description">
    <meta content="" name="keywords">

    <link th:href="@{/static/assets/img/download.png}" rel="icon">
    <link href="https://fonts.gstatic.com" rel="preconnect">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">
    <!-- Vendor CSS Files -->
    <link th:href="@{/static/assets/vendor/bootstrap/css/bootstrap.min.css}" rel="stylesheet">
    <link th:href="@{/static/assets/vendor/bootstrap-icons/bootstrap-icons.css}" rel="stylesheet">
    <link th:href="@{/static/assets/vendor/boxicons/css/boxicons.min.css}" rel="stylesheet">
    <link th:href="@{/static/assets/vendor/quill/quill.snow.css}" rel="stylesheet">
    <link th:href="@{/static/assets/vendor/quill/quill.bubble.css}" rel="stylesheet">
    <link th:href="@{/static/assets/vendor/remixicon/remixicon.css}" rel="stylesheet">
    <link th:href="@{/static/assets/vendor/simple-datatables/style.css}" rel="stylesheet">

    <link th:href="@{/static/assets/css/style.css}" rel="stylesheet">
    <link th:href="@{/static/assets/css/post.css}" rel="stylesheet">
    <link th:href="@{/static/assets/css/all.css}" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/sockjs-client/dist/sockjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/stompjs/lib/stomp.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <link th:href="@{/static/assets/css/groupPage.css}" rel="stylesheet">
    <link th:href="@{/static/assets/css/groupChatsya.css}" rel="stylesheet">
    <link th:href="@{/static/assets/css/poll.css}" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/5.1.3/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


</head>
<style>
    .userDiv{
        margin: 5px;
        padding: 2px 2px 2px 2px;
        border-radius: 4px;
        background: #d3d3e8;
        display: flex;
        flex-direction: row;
        justify-content: space-between;
    }
    .poll-user-profile{
        text-decoration: underline;
        cursor: pointer;
        display: flex;
        justify-content: flex-start;
    }
    .poll-user-profile img{
        margin: 5px 11px;
        display: inline-block;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        align-self: center;
    }
    .trash-button {
        opacity: 0.7;
        margin-left: 170px;
        padding: 20px;
        font-size: 20px;
    }
    .poll-user-profile i:hover{
        color: black;
    }
    .poll-user-name{
        width:100px;
        color: black;
        margin-top: 4px;
        font-weight: 600;
        font-family: "Nunito", sans-serif;
    }
</style>
<body>

<div th:include="header"></div>

<!-- ======= Sidebar ======= -->
<div th:include="sidebar"></div>
<main id="main" class="main">

    <!-- Banner Area Start Here -->

    <div class="banner">

        <div class="container text-center">
            <div class="row">
                <div class="banner_img" style="width: 1000px;height: 190px">
                    <div th:each="group : ${groups}">
                        <img th:src="${group.image}" alt="groupImage" style="border-radius: 20px;margin-top: 20px; box-shadow: 10px 10px 20px 0 rgba(0, 0, 0, 0.2);width: 100%">
                    </div>
                </div>
                <div class=>
                    <div class="container groupInfomation">

                        <div class="row" >
                                    <div th:each="group : ${groups}">
                                        <div class="content-holder" style="display: flex;justify-content: space-between;">
                                    <h2 th:text="${group.name}" style="font-weight: 600">Group Name</h2>
                                        <i style="padding: 10px;font-size: 18px; cursor: pointer;color: black" class="fa-solid fa-bolt thunder-icon" id="openModalsya"></i>
                                        </div>
                                        <div class="group_description">
                                            <div th:text="${group.description}" style="display: flex;margin-bottom: 10px;color: #141415;"></div>
                                        </div>

                                        <div class="members">
                                            <div class="userCount" style="width: 300px">
                                                <ul class="groupUserProfile" style="padding: 0"></ul>
                                                <p class="text-left" style="padding-top: 4px;"><span style="margin-left: 30px;font: icon" th:text="${group.memberCount} +Members"></span> </p>
                                            </div>
                                            <div class="groupBtn" style="margin-left: 380px;display: flex">
                                                <button type="button" class="inviteBtn" value="Invite" id="inviteBtn" onclick="populateCreateGroupFormForInvitation()"><i class="fa-solid fa-user-plus" style="color: black;"></i>Invite</button>
                                                <button type="button" class="joinBtn" id="userRequestToJoinBtn"><i class="fa-solid fa-user-check"></i></button>
                                            </div>
                                        </div>
                                </div>
<!--                            <div class="col-lg-6 banner_mid_right">-->

<!--                                <div id="invitationMessage"></div>-->
<!--                            </div>-->
                            <div id="myModalsya" class="modalsya">

                                <!-- Modal content -->
                                <div class="modal-contentsya">
                                    <span class="closesya">&times;</span>
                                    <div id="notificationssya" style="width: 440px">
                                        <!-- Notifications will be generated here -->
                                    </div>
                                </div>

                            </div>
                        </div>


                    </div>
                </div>

                <div class="banner_bottom">
                    <div class="banner_bottom_menu">
                        <ul id="mediaTag">
                            <li id="topPost">Top</li>
                            <li id="latestPost">Latest</li>
                            <li id="groupPoll">Poll</li>
                            <li id="aboutCommunity">About</li>
                        </ul>
                    </div>
                </div>


                <div class="container">
                    <div class="modal fade" id="invitationFormModal" tabindex="-1" aria-labelledby="createCommunityModalLabel" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="createGroupModalLabel">Invite Members</h5>
                                </div>

                                <div class="modal-body" style="display: flex;flex-direction: column;overflow-y: auto;max-height: 350px;">
                                    <form id="inviteForm">
                                        <input type="hidden" id="communityId1" name="communityId">
                                        <div class="row mb-4">
                                            <input type="text" class="form-control" id="userSearch" placeholder="Search users.." width="100%">
                                            <div id="usersList"></div>
                                        </div>
                                        <input type="hidden" id="userIds" name="userIds">
                                    </form>
                                </div>

                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" id="inviteModalCloseBtn">Close</button>
                                    <button type="button" class="btn btn-primary" id="inviteUserBtn">Invite</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <section class="section dashboard">
        <div class="row">

            <div id="mainContent" class="center-flex-container flex-item" style="margin-left: 200px">
                <!-- GroupPost-->
                <div class="groupPostContainer" style="width: 600px"><!-- Content will be set dynamically --></div>
                <div class="topPostContainer" style="width: 600px"><!-- Content will be set dynamically --></div>
                <div class="group-polls-container" style="width:600px"> </div>
            </div>


            <div class="center-flex-container flex-item about_community" style="display: none">
                <div class="community-info">
                    <h2>Community Info</h2>
                    <p><i class="fa-solid fa-users" style="color: black"></i><strong style="margin-left: 10px">Only members can post, like, or reply.</strong></p>
                    <p><i class="fa-solid fa-lock" style="color: black"></i><strong style="margin-left: 10px">All Communities are publicly visible.</strong><br><span>To join this Community, you must ask and be approved.</span></p>
                    <p>
                        <i class="fa-solid fa-calendar-days" style="color: black"></i>
                        <strong style="margin-left: 10px">
                            Created April 28, 2024 by
                            <span th:each="group : ${groups}"><span th:text="'@' + ${group.ownerUserName}"></span></span></strong>
                    </p>

                    <div class="rules">
                        <h2>Rules</h2>
                        <div th:each="group : ${groups}">
                            <div th:text="${group.rule}"></div>
                        </div>
                    </div>
                </div>

                <div class="GroupMembers">
                    <span class="member">Members:</span><input class="userSearchGP" type="text" placeholder="Search Users">
                    <div class="userContainer" style="min-height: 500px">

                    </div>
                </div>
            </div>

<!--            <div id="confirmationModal" class="kickModal" style="display: none;">-->
<!--                <div class="modal-contentkicksya">-->
<!--                    <p>Are you sure you want to kick this user?</p>-->
<!--                    <button id="confirmKickBtn">OK</button>-->
<!--                    <button id="cancelKickBtn">Cancel</button>-->
<!--                </div>-->
<!--            </div>-->

            <div class="modal fade" id="confirmationModalKick" tabindex="-1" aria-labelledby="confirmationModalLabelKick" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content" style="width: 450px">
                        <div class="modal-header" style="background-color: #dfeee6">
                            <h5 class="modal-title" id="confirmationModalLabelKick">Confirmation</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            Are you sure you want to kick this user?
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-primary" style="background-color: #3f96ed;border: none;" id="confirmKickBtn">OK</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal fade" id="confirmationModalAdmin" tabindex="-1" aria-labelledby="confirmationModalLabelAdmin" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content" style="width: 450px">
                        <div class="modal-header" style="background-color: #dfeee6">
                            <h5 class="modal-title" id="confirmationModalLabelAdmin">Confirmation</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            Are you sure you want to give this user to Admin?
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-primary" style="background-color: #3f96ed;border: none;" id="confirmAdminBtn">Sure</button>
                        </div>
                    </div>
                </div>
            </div>


            <div class="openChat" style="width: 50px;height: 50px">
                <i class="fa-regular fa-comment"></i>
            </div>
            <!-- GroupChatRoom-->
            <div class="right-flex-container flex-item" id="chatRoom" style="display: none">
                <div class="chat-room">
                    <div class="chat-header">
                        <img class="groupProfile" alt="Profile">
                        <div class="gpImg-container" style="display: flex;justify-content: space-between;width: 100vh">
                            <div class="header-top">
                                <div style="display: flex">
                                    <div class="title"></div>
                                    <i class="fa-solid fa-video" id="vd-icon" style="color: black;margin-left: 30px"></i>
                                </div>
                                <div class="subtitle"> </div>
                            </div>
                            <div class="closeChat" style="font-size: 20px;">
                                <i class="fa-solid fa-xmark" style="color: black"></i>
                            </div>
                        </div>
                    </div>
                    <div class="chat-container">

                    </div>
                    <div class="chat-input">
                        <div style="margin: 5px; cursor:pointer;">
                            <input type="file" id="imageUpload" accept="image/*" style="display: none;">
                            <i class="fa-solid fa-images" id="imageUploadIcon" style="color: black"></i>
                        </div>
                        <div style="margin: 5px; cursor: pointer" ><i class="fa-solid fa-microphone audioButton" style="color: black"></i></div>

                        <input type="text" id="message" placeholder="Write a text">
                        <button class="emoji-button">ðŸ˜Š</button>
                        <div class="actions">
                            <button id="groupChatSend">Send</button>
                        </div>
                        <div id="recordingIndicator" style="display:none;">Recording...</div>
                    </div>

                </div>
            </div>

            <div class="modal fade" id="editMessageModal" tabindex="-1" aria-labelledby="editMessageModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="editMessageModalLabel">Edit Message</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <input type="text" class="form-control" id="editMessageInput">
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary" id="saveEditMessage">Save changes</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal fade" id="deleteMessageModal" tabindex="-1" aria-labelledby="deleteMessageModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="deleteMessageModalLabel">Delete Message</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            Are you sure you want to delete this message?
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-danger" id="confirmDeleteMessage">Delete</button>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </section>

    <div class="modal fade" id="deletePollFromGroup" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Are You Sure to Delete?</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">No</button>
                    <button type="button" class="btn btn-danger" id="confirmDeleteButton">Yes</button>
                </div>
            </div>
        </div>
    </div>

    <!--PollTotalVoteResult Modal Box-->
    <div class="modal fade" id="pollTotalVoteResultForGroup" tabindex="-1" aria-labelledby="PollResultForGroupLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5"> votes</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body d-flex" style="display: flex;">
                    <div class="poll-sidebar bg-light p-3" style="width: 200px;">

                        <ul class="list-unstyled pollOptionLi">

                        </ul>
                    </div>
                    <div class="pollCount-content p-3" style="flex-grow: 1;display: flex;justify-content: center;">
                        <!-- Main content here -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Popper.js first, then Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/js/bootstrap.min.js"></script>
</main>

<div th:include="footer"></div>
<script>
    const getCommunities = () => {
        console.log("Click event is occurred");
        fetch("/communityview", {
            method: 'GET'
        })
            .then(response => response.json())
            .then(data => {
                const groupDropDown = document.getElementById('icons-nav');
                const groupList = document.getElementById('groupList');
                if (data !== null) {
                    groupList.innerHTML='';
                    data.forEach(group => {
                        const li = document.createElement('li');
                        const userImage = document.createElement('img'); // Creating img element
                        userImage.src = group.image; // Setting src attribute
                        userImage.alt = group.name; // Setting alt attribute
                        userImage.classList.add('imageIcon'); // Adding CSS class

                        const anchor = document.createElement('a');
                        anchor.href = "/groupPage/" + group.id;

                        anchor.appendChild(userImage); // Append image to anchor

                        const span = document.createElement('span');
                        span.textContent = group.name;

                        anchor.appendChild(span); // Append span to anchor

                        li.appendChild(anchor); // Append anchor to list item
                        groupList.appendChild(anchor);
                        groupDropDown.appendChild(groupList); // Append list item to dropdown

                    })
                }
            })
    }
</script>
<!--<script th:src="@{/static/assets/js/invitation.js}"></script>-->
<script th:src="@{/static/assets/js/successfulmessage.js}"></script>
<script th:src="@{/static/assets/js/group-poll.js}"></script>
<script type="module" src="../static/assets/js/groupPost.js" defer></script>
<!-- Vendor JS Files -->
<script th:src="@{/static/assets/vendor/apexcharts/apexcharts.min.js}"></script>
<script th:src="@{/static/assets/vendor/bootstrap/js/bootstrap.bundle.min.js}"></script>
<script th:src="@{/static/assets/vendor/chart.js/chart.umd.js}"></script>
<script th:src="@{/static/assets/vendor/echarts/echarts.min.js}"></script>
<script th:src="@{/static/assets/vendor/quill/quill.min.js}"></script>
<script th:src="@{/static/assets/vendor/simple-datatables/simple-datatables.js}"></script>
<script th:src="@{static/assets/vendor/tinymce/tinymce.min.js}"></script>
<script th:src="@{/static/assets/vendor/php-email-form/validate.js}"></script>
</body>
<a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>
<!--<script th:src="@{/static/assets/js/postDisplay.js}"></script>-->
<script th:src="@{/static/assets/js/videoplayer.js}"></script>
<script th:src="@{/static/assets/js/newChat.js}"></script>
<script th:src="@{/static/assets/js/invitation.js}"></script>

</html>