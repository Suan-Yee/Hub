spring.application.name=SocialGod
spring.application.title=SocialGod
spring.application.version=1.0

# ============================================
# Database Configuration (Performance Optimized)
# Supply credentials via env: DB_PASSWORD, DB_USERNAME, DB_URL. For local dev use profile 'dev' and set env or override in application-dev.properties.
# ============================================
spring.datasource.url=${DB_URL:jdbc:mysql://localhost:3306/socialgod?useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true}
spring.datasource.username=${DB_USERNAME:root}
spring.datasource.password=${DB_PASSWORD:}

# HikariCP Connection Pool (managed by DatabaseConfig.java)
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.leak-detection-threshold=60000

# JPA/Hibernate (default: validate for prod; use profile 'dev' or application-dev.properties for ddl-auto=update)
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.properties.hibernate.jdbc.batch_size=25
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.fetch_size=50
spring.jpa.properties.hibernate.default_batch_fetch_size=16
spring.jpa.properties.hibernate.query.in_clause_parameter_padding=true
spring.jpa.properties.hibernate.generate_statistics=false
spring.jpa.show-sql=false
spring.jpa.open-in-view=false

# Flyway
spring.flyway.baseline-on-migrate=true

# ============================================
# Caching Configuration (Redis + Caffeine)
# ============================================

# Redis Configuration (Optional - comment out if not using Redis)
# spring.data.redis.host=localhost
# spring.data.redis.port=6379
# spring.data.redis.password=
# spring.data.redis.timeout=60000
# spring.data.redis.lettuce.pool.max-active=8
# spring.data.redis.lettuce.pool.max-idle=8
# spring.data.redis.lettuce.pool.min-idle=2

# Cache Type (caffeine = local, redis = distributed)
spring.cache.type=caffeine
spring.cache.caffeine.spec=maximumSize=10000,expireAfterWrite=15m,expireAfterAccess=10m

# ============================================
# Actuator & Monitoring
# ============================================
management.endpoints.web.exposure.include=health,metrics,prometheus,info,caches
management.metrics.enable.jvm=true
management.metrics.enable.process=true
management.metrics.enable.system=true
management.metrics.enable.tomcat=true
management.metrics.enable.hikaricp=true
management.endpoint.health.show-details=when-authorized
management.endpoint.metrics.enabled=true
management.endpoint.prometheus.enabled=true

# Mail (supply MAIL_PASSWORD via env in production; rotate if previously committed)
spring.mail.username=${MAIL_USERNAME:}
spring.mail.host=${MAIL_HOST:smtp.gmail.com}
spring.mail.port=${MAIL_PORT:587}
spring.mail.password=${MAIL_PASSWORD:}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.debug=false

server.error.whitelabel.enabled=false
server.error.path=/error

spring.servlet.multipart.max-file-size=100MB
spring.servlet.multipart.max-request-size=100MB

# CORS for React frontend (comma-separated for multiple origins)
app.cors.allowed-origins=http://localhost:3000

# ============================================
# WebSocket Configuration (Performance Optimized)
# ============================================

# Message size limits (in bytes)
websocket.message-size-limit=131072
websocket.send-buffer-size-limit=1048576
websocket.send-time-limit=20000

# Heartbeat & Connection Health
websocket.heartbeat-interval=20000
websocket.max-missed-heartbeats=3
websocket.session-idle-timeout=600000
websocket.stale-session-cleanup-interval=300000

# Thread Pool Configuration
websocket.thread-pool-size=10
websocket.thread-pool-queue-capacity=200

# Performance Features
websocket.compression-enabled=true
websocket.metrics-enabled=true

# CORS Configuration for WebSocket
websocket.cors.allowed-origins=http://localhost:3000,http://localhost:3001
websocket.cors.allow-credentials=true

# STOMP Relay (Optional - for external message brokers like RabbitMQ)
# Enable this for production scaling with external message broker
websocket.relay.enabled=false
websocket.relay.host=localhost
websocket.relay.port=61613
websocket.relay.client-login=guest
websocket.relay.client-passcode=guest
websocket.relay.system-login=guest
websocket.relay.system-passcode=guest
websocket.relay.virtual-host=/

